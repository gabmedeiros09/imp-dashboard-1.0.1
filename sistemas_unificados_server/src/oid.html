<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Impressoras - SEPROR</title>
    <link rel="shortcut icon" href="src/logo_gov.ico" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: #e3e9f7;
        }

        header {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            position: sticky;
            top: 0;
            z-index: 3;
        }

        header h1 {
            margin: 0;
            flex-grow: 1;
        }

        header .logo-left {
            width: 140px;
        }

        header .logo-right {
            width: 100px;
        }


        .page-wrapper {
            display: flex;
            flex: 1;
        }

        #sidebar {

            display: flex;
            flex-direction: column;
            justify-content: space-between;
            background-color: #0D57A1;
            height: calc(100vh - 74px);
            border-radius: 0px 18px 18px 0px;
            position: relative;
            transition: all .5s;
            min-width: 82px;
            z-index: 2;
        }

        #sidebar_content {
            padding: 12px;
        }

        #side_items {

            display: flex;
            flex-direction: column;
            gap: 8px;
            list-style: none;
        }

        .side-item {

            border-radius: 8px;
            padding: 14px;
            cursor: pointer;
        }



        .side-item:hover:not(.active) {
            background-color: #2a69fd;
        }

        .side-item a {


            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffff;
            transition: justify-content .6s ease, gap .6s ease;
        }


        .side-item a i {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
        }

        #open_btn {
            position: absolute;
            top: 30px;
            right: -10px;
            background-color: #0d0772;
            color: #e3e9f7;
            border-radius: 100%;
            width: 20px;
            height: 20px;
            border: none;
            cursor: pointer;
        }

        #open_btn_icon {
            transition: transform .3s ease;
        }

        .open-sidebar #open_btn_icon {
            transform: rotate(180deg);
        }

        .open-sidebar #open_btn_icon {
            transform: rotate(180deg);
        }


        .item-description {
            width: 0px;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 18px;
            white-space: nowrap;
            transition: width .6s, max-height .6s;


        }


        #sidebar.open-sidebar {
            min-width: 11%;
        }

        #sidebar.open-sidebar .item-description {
            width: 150px;
            max-height: 50px;
        }

        #sidebar.open-sidebar .side-item a {
            display: flex;
            justify-content: flex-start;
            gap: 14px;

        }

        #sidebar.open-sidebar .item-description {
            width: 80px;
        }



        main {
            flex: 1;
            margin-top: 20px;
            padding: 30px;
            overflow-y: auto;

        }

        main h2,
        h3 {
            margin-bottom: 20px;
            padding: 3px;

        }

        #main_2 {
            flex: 2;
            margin-top: 8px;
            padding: 30px;
            overflow-y: auto;
        }


        .content-section.hidden {
            display: none;
        }


        .content-section {
            display: flex;
            flex-direction: column;
            justify-content: center;
            width: 68%;
            max-width: none;
            margin: 15px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        #erros {
            margin-top: -30px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input[type="text"] {

            width: 100%;
            padding: 18px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }



        .button-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;

        }

        .submitBtn {

            background-color: #033d6dd7;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        .submitBtn2 {

            background-color: #f10101;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }



        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px;
            width: 100%;
        }

        .divider {
            display: block;
            width: 100%;
            height: 5px;
            left: 0;
            margin: 0.1px 0.5px;
        }
    </style>
</head>

<body>
    <header>
        <a href="/dashboard"><img src="/src/LOGO_GOV.png" alt="Logo Governo" class="logo-left"></a>
        <h1>Configuração de Oids - SEPROR</h1>
        <img src="/src/LOGO_SEPROR.png" alt="Logo SEPROR" class="logo-right">
    </header>

    <div class="page-wrapper">
        <nav id="sidebar">
            <div id="sidebar_content">
                <ul id="side_items">
                    <li class="side-item active" data-section="toner">
                        <a href="#"><i class="fa-solid fa-print"></i><span class="item-description">Toner</span></a>
                    </li>
                    <li class="side-item" data-section="tambor">
                        <a href="#"><i class="fa-solid fa-drum"></i><span class="item-description">Tambor</span></a>
                    </li>
                    <li class="side-item" data-section="erros">
                        <a href="#"><i class="fa-solid fa-triangle-exclamation"></i><span
                                class="item-description">Erros</span></a>
                    </li>
                    <li class="side-item" data-section="outros">
                        <a href="#"><i class="fa-solid fa-gear"></i><span class="item-description">Outros</span></a>
                    </li>
                </ul>

                <button id="open_btn">
                    <i id="open_btn_icon" class="fa-solid fa-chevron-right"></i>
                </button>
            </div>
        </nav>

        <main id="content">
            <form id="oidForm">
                <div id="toner" class="content-section">
                    <h2>Oids de Toner</h2>
                    <div class="form-group">
                        <label for="toner_black">Toner Preto OID:</label>
                        <input type="text" id="toner_black" name="toner_black"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="toner_cyan">Toner Ciano OID:</label>
                        <input type="text" id="toner_cyan" name="toner_cyan"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="toner_magenta">Toner Magenta OID:</label>
                        <input type="text" id="toner_magenta" name="toner_magenta"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="toner_yellow">Toner Amarelo OID:</label>
                        <input type="text" id="toner_yellow" name="toner_yellow"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                </div>

                <div id="tambor" class="content-section hidden">
                    <h2>Oids de Tambor</h2>
                    <div class="form-group">
                        <label for="life_tambor"> Vida Restante do Tambor:</label>
                        <input type="text" id="life_tambor" name="life_tambor"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="max_tambor"> Vida Máxima do Tambor:</label>
                        <input type="text" id="max_tambor" name="max_tambor"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                </div>

                <div id="erros" class="content-section hidden">
                    <h2>Oids de Detalhes de Erro </h2>
                    <div class="form-group">
                        <label for="erro_status_oid"> Erro Básico:</label>
                        <input type="text" id="erro_status_oid" name="erro_status_oid"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="erro_detail_oid"> OID Detalhe de Erro:</label>
                        <input type="text" id="erro_detail_oid" name="erro_detail_oid"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <h3>Monocromática </h3>
                    <div class="form-group">
                        <label for="mono_1"> Erro Linha 1: </label>
                        <input type="text" id="mono_1" name="mono_1" placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="mono_2"> Erro Linha 2: </label>
                        <input type="text" id="mono_2" name="mono_2" placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="mono_3"> Erro Linha 3: </label>
                        <input type="text" id="mono_3" name="mono_3" placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>

                    <h3>Colorida</h3>
                    <div class="form-group">
                        <label for="color_1"> Erro Linha 1: </label>
                        <input type="text" id="color_1" name="color_1" placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="color_2"> Erro Linha 2: </label>
                        <input type="text" id="color_2" name="color_2" placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="color_3"> Erro Linha 3: </label>
                        <input type="text" id="color_3" name="color_3" placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                </div>

                <div id="outros" class="content-section hidden">
                    <h2>Demais OIDS </h2>
                    <div class="form-group">
                        <label for="hostname_oid"> Hostname Oid:</label>
                        <input type="text" id="hostname_oid" name="hostname_oid"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                    <div class="form-group">
                        <label for="serial_oid"> Serial Oid:</label>
                        <input type="text" id="serial_oid" name="serial_oid"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>

                    <div class="form-group">
                        <label for="counter_oid"> Contador de uso Oid:</label>
                        <input type="text" id="counter_oid" name="counter_oid"
                            placeholder="Ex: 1.3.6.1.2.1.x.x.x.x.x.x.x">
                    </div>
                </div>

                <section class="button-content">
                    <button type="submit" class="submitBtn">Salvar Oids</button>
                    <button type="button" class="submitBtn2">Limpar Formulário</button>
                    <button type="button" id="submitBtn3" class="submitBtn">Restaurar Padrões</button>


                </section>
            </form>
        </main>
    </div>


    <script>
        // menu pra acessar barra lateral
        document.addEventListener('DOMContentLoaded', () => {
            const sidebar = document.getElementById('sidebar');
            const openBtn = document.getElementById('open_btn');
            const sideItems = document.querySelectorAll('.side-item');
            const contentSections = document.querySelectorAll('.content-section');
            const oidForm = document.getElementById('oidForm');
            const clearFormBtn = document.querySelector('.submitBtn2');

            openBtn.addEventListener('click', () => {
                sidebar.classList.toggle('open-sidebar');
            });

            function showSection(sectionName) {
                contentSections.forEach(section => {
                    section.classList.toggle('hidden', section.id !== sectionName);
                });

                sideItems.forEach(item => {
                    item.classList.toggle('active', item.getAttribute('data-section') === sectionName);
                });
            }

            sideItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionName = item.getAttribute('data-section');
                    showSection(sectionName);
                });
            });

            loadOids();

            // Função para carregar oids do formulário
            function loadOids() {
                fetch('/oids')
                    .then(response => response.ok ? response.json() : Promise.reject('Falha ao carregar OIDs.'))
                    .then(data => {
                        if (data) {
                            Object.keys(data).forEach(key => {
                                const input = document.getElementById(key); // O 'key' aqui será 'toner_black', etc.
                                if (input) {
                                    input.value = data[key];
                                }
                            });
                        }
                    })
                    .catch(error => console.error('Erro ao carregar OIDs:', error));
            }

            // botão para salvar oids 
            oidForm.addEventListener('submit', (event) => {
                event.preventDefault();
                const formData = new FormData(oidForm);
                const dataToSave = Object.fromEntries(formData.entries());

                let verifyField = true;
                for (const value of Object.values(dataToSave)) {
                    if (value.trim() === '') {
                        verifyField = false;
                        break;
                    }
                }
                // verifica os campos

                if (!verifyField) {
                    alert('Preencha todos os campos');
                    return;
                }

                saveOids(dataToSave);
            });

            function saveOids(dataToSave) {
                fetch('/oids', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(dataToSave),
                })
                    .then(response => response.json())
                    .then(result => {
                        alert(result.message || (result.success ? 'OIDs salvos com sucesso!' : 'Ocorreu um problema.'));
                    })
                    .catch(error => {
                        console.error('Erro ao salvar OIDs:', error);
                        alert('Ocorreu um erro ao salvar as configurações.');
                    });
            }
//      restaurar padrões 
//        document.getElementById('submitBtn3').addEventListener('click', () => {
    
            // limpar formulario **pensando em tirar isso no fim (talvez)
            clearFormBtn.addEventListener('click', () => {
                if (confirm('Tem certeza que deseja limpar todos os campos do formulário?')) {
                    oidForm.reset();
                }
            });


            showSection('toner');
        });
    </script>
</body>

<!-- Rodapé -->
<footer>
    <img src="src/LINHA.png" alt="Linha divisória" class="divider">
    <p>&copy; 2025 - Secretária de Estado de Produção Rural - SEPROR. Desenvolvido por Renato Pedrozo (GILOG)</p>
</footer>

</html>